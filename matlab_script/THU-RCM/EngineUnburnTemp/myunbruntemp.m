function dy=myunbruntemp(theta,y,ca,p,dp,dv)
dy=zeros(6,1);
mu=y(1);
mb=y(2);
vu=y(3);
vb=y(4);
tu=y(5);
tb=y(6);
enginedata;
cm=omega*stroke/pi;
tm=(mu*tu+mb*tb)/(mu+mb);
pp=interp1(ca,p,theta,'linear');
hg=0.04*(pp)^0.7*tm^-0.2*cm^0.7*b^-0.3*10^2.8;
qm1=hg*(tm-tw)*(b/2)^2*pi;%活塞顶传热
qm2=hg*(tm-tw)*(pi*b)*(x+stroke/(cr-1));%缸壁传热
qm2=interp1(ca_alpha,qm2,theta*pi/180,'linear');
qm3=hg*(tm-tw)*(b/2)^2*pi;%缸盖底面传热
qm=(qm1+qm2+qm3)/(21600*RPM);
qb=mb*tb*qm/(mu*tu+mb*tb);
qu=mu*tu*qm/(mu*tu+mb*tb);
B=zeros(6,1);
dvv=interp1(ca,dv,theta,'linear');
B(2)=dvv;
B(3)=qu;
B(4)=qb;
dpp=interp1(ca,dp,theta,'linear');
B(5)=-dpp/pp;
B(6)=B(5);
A=zeros(6,6);
A(1,1)=1;
A(1,2)=1;
A(2,3)=1;
A(2,4)=1;
[hu,uu,~,~,~,~,cvu,~,~]=farg(pp,tu,phi,f,fueltype,airscheme);
[hb,ub,~,~,~,~,cvb,~,~]=ecp(pp,tb,phi,fueltype,airscheme);
A(3,1)=uu-hu;
A(3,3)=pp;
A(3,5)=cvu*mu;
A(4,2)=ub-Hu/(1+L0*phi)-hb;
A(4,4)=pp;
A(4,6)=cvb*mb;
A(5,1)=-1/mu;
A(5,3)=1/vu;
A(5,5)=-1/tu;
A(6,2)=-1/mb;
A(6,4)=1/vb;
A(6,6)=-1/tb;
X=A\B;
dy(1)=X(1);
dy(2)=X(2);
dy(3)=X(3);
dy(4)=X(4);
dy(5)=X(5);
dy(6)=X(6);